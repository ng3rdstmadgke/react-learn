Next.jsのインストール
---

- https://nextjs.org/learn/react-foundations/installation
- [ソースコード](../../react_tutorial/9_installing_nextjs/)


# NextJSのインストール


```bash
npm install react@latest react-dom@latest next@latest
```


```bash
mkdir app
```

# ページの実装

`app/page.js`

```jsx
import { useState } from 'react';

function Header({ title }) {
  return <h1>{title ? title : "Default title"}</h1>;
}

// export defaultを追加すると、Next.jsがページのメインコンポーネントとしてレンダリングするコンポーネントを区別できるようになります。
export default function HomePage() {
  const names = ["Alice", "Bob", "Charlie"];
  const [likes, setLikes] = useState(0);

  function handleClick() {
    setLikes(likes + 1);
  }

  return (
    <div>
      <Header title="Develop. Preview. Ship." />
      <ul>
        {
          names.map((name, i) => (
            <li key={i}>{name}</li>
          ))
        }
      </ul>
      <button onClick={handleClick}>Like ({likes})</button>
    </div>
  )
}
```

# 開発サーバーの起動

`package.json`

```js
{
  // scriptsを追加
  "scripts": {
    "dev": "next dev" 
  },
  "dependencies": {
    "next": "^14.0.3",
    "react": "^18.3.1",
    "react-dom": "^18.3.1"
  }
}
```


```bash
npm run dev
```


http;//localhost:3000 にアクセスすると以下のエラーが表示されます。


```
./app/page.js

## Error Type
Build Error

## Error Message
  × You're importing a component that needs `useState`. This React Hook only works in a Client Component. To fix, mark the file (or its parent) with the `"use client"` directive.

## Build Output
./app/page.js
Error:   × You're importing a component that needs `useState`. This React Hook only works in a Client Component. To fix, mark the file (or its parent) with the `"use client"` directive.
  │
  │  Learn more: https://nextjs.org/docs/app/api-reference/directives/use-client
  │

   ╭─[/workspaces/react-learn/react_tutorial/9_installing_nextjs/app/page.js:1:1]
 1 │ import { useState } from 'react';
   ·          ────────
 2 │ 
 3 │ function Header({ title }) {
 4 │   return <h1>{title ? title : "Default title"}</h1>;
   ╰────

Next.js version: 15.5.4 (Webpack)
```


これは、Next.jsがReact Server Componentsという新機能を使用しているためです。この機能により、Reactがサーバー上でレンダリングできるようになります。Server ComponentsはuseStateをサポートしていないため、代わりにClient Componentを使用する必要があります。

次の章では、Server ComponentsとClient Componentsの主な違いについて説明し、このエラーを修正します。


# layout.js


サーバーを起動すると `app/layout.js` が自動生成されます。これはアプリケーションのメインレイアウトです。全ページで共有されるUI要素（例：ナビゲーション、フッターなど）を追加するために使用できます。

`app/layout.js`

```js
export const metadata = {
  title: 'Next.js',
  description: 'Generated by Next.js',
}

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}

```